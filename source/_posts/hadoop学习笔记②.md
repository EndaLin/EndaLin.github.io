---
title: Hadoop学习笔记②
copyright: true
date: 2019-06-25 11:17:14
tags: Hadoop
---

# 分布式文件系统HDFS

#### 计算机集群架构

集群中的计算机结点存放在机架上， 每个机架可以存放8-64个结点， 同一个机架上的不同节点通过网络互联， 多个不同机架之间采用另一级网络或交换机互联。

![image.png](https://upload-images.jianshu.io/upload_images/13918038-ebe980d9266154b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### 分布式文件系统的结构
分布式文件系统在物理结构上是由计算机集群中的多个节点构成的， 这些节点分为两类：
- 主节点或者是**名称节点(NameNode)**：负责文件和目录的创建、删除和重命名等，同时管理着数据节点和文件块的映射关系， 客户端只有访问名称结点才能请求文件块所在的位置，进而找到相应位置读取所需文件块。
- 从结点或者是**数据结点(DataNode)**：负责数据的存储和读取， 在存储时， 由名称结点分配存储位置， 然后由客户端把数据直接写入相应数据节点

在读取数据时， 客户端从名称节点获取数据节点和文件块的映射关系， 然后就可以到相应位置访问文件块。

数据节点也要根据名称节点的命令创建、删除数据块和冗余复制。

为了保证数据的完整性， 分布式文件系统通常采用多副本存储， 文件块会被复制为多个副本， 存储在不同的节点上， 而且存储同一个文件块的不同副本的各个节点会分布在不同机架上， 这样， 在单个节点出现故障时， 就可以快速调用副本重启单个节点上的计算过程， 而不用重启整个计算过程。

分布式文件系统是针对大规模数据存储而设计的（TB级别）， 规模过小会影响性能。

![image.png](https://upload-images.jianshu.io/upload_images/13918038-2c0b31c9aa83662e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### HDFS特性
- 兼容廉价硬件设备
- 流数据读写
- 大数据集
- 简单的文件模型
- 强大的跨平台特性
- 不适合低延迟数据访问， 主要面向大规模数据批量处理而设计的， 采用流式数据读取， 具有很高的吞吐率， 高延迟（对于低延时要求的应用程序， HBase是一个更好的选择）
- 无法高效存储大量小文件
- 不支持多用户写入以及任意修改文件


#### HDFS的相关概念
##### 块
在传统的文件系统中，为了提高磁盘的读写效率， 一般以数据块为单位， 而不是以字节为单位。

HDFS也采用了快的概念， 默认一个块大小是64MB， 在HDFS中的文件会被拆分成多个块， 每个块作为独立的单元进行存储。

HDFS在块的大小设计明显大于普通文件系统， 为的是最小化寻址开销（磁盘寻道开销和数据块定位开销）

通常MapReduce中的Map任务一次只处理一个块中中的数据

HDFS采用抽象块概念可以带来几个好处：
- **支持大规模文件存储**： 一个大规模文件可以被拆分成若干个文件块， 不同的文件块被分发到不同的节点上， 因此一个文件的大小不会受到单个节点的存储容量的限制， 可以远大于任意节点的存储容量。
- **简化系统设计**：方便计算一个节点可以存储多少个文件块，其次，方便元数据的管理，元数据不需要和文件夹一起存储，可以由其他系统负责管理元数据。
- **适合数据备份**：每个文件块可以冗余存储到多个节点上，大大提高了系统的容错性和可用性。
